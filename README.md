# rnaaln
ICGC ARGO Workflow for RNA-Seq Alignment

## 1. Parameters
Currently parameters are configured in `conf/test_local.config` and `conf/test_rdpc.config`. They can be specified by command line too.
### 1.1 Required Parameters 
#### 1.1.1 Both rdpc and local mode
  * reference_fasta="PATH/TO/genome.fa"
  * reference_fai = "PATH/TO/genome.fa.fai"
  * reference_gtf = "PATH/TO/annotation.gtf"
  * reference_splicesites = "PATH/TO/splicesites.txt"
  * rrna_intervals = "PATH/TO/rRNA.interval_list"
  * ref_flat = "PATH/TO/refFlat.hg38.txt.gz"
  * hisat2_index = "PATH/TO/genome.index_HISAT2"
  * star_index = "PATH/TO/genome.index_STAR"
  * genome_build = "GENOME BUILD"
  * genome_annotation = "GENOME ANNOTATION"
#### 1.1.2 RDPC mode
  * analysis_id="ANALYSIS_ID"
  * study_id="STUDY_ID"
#### 1.1.3 Local mode
  * samplesheet="PATH/TO/SAMPLESHEET.csv"
    
### 1.2 Optional Parameters
   * reference_trans_fasta = "PATH/TO/transcript.fa"
   * reference_trans_fai = "PATH/TO/transcript.fa.fai"

Transcriptome reference files are used in `star_aln` pipeline to generate transcriptome based alignemnts. The transcriptome reference fasta and fai file can be provided. If not, they will be generated by genome fasta and gtf files. 

## Tool Options
  * hisat2_aln
  * star_aln
  * markdup
  * cleanup

One or more tools can be specified in the command line.

## Minimal tests

```
nextflow run main.nf -profile docker,test_local --tools hisat2_aln,star_aln,markdup
```

## RDPC_qa tests
Full test
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,star_aln,markdup,cleanup --api_token ####
```
Without cleanup
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,star_aln,markdup --api_token ####
```
Without markdup
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,star_aln,cleanup --api_token ####
```
With only hisat2
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,markdup,cleanup --api_token ####
```
With only star
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,star_aln,markdup,cleanup --api_token ####
```
Without transcriptome reference

First, comment out `reference_trans_fasta` and `reference_trans_fai` in `conf/test_rdpc.config`; Second, run:
```
nextflow run main.nf -profile docker,test_rdpc,rdpc_qa --tools hisat2_aln,star_aln,markdup,cleanup --api_token ####
```
